<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naruto Ultimate Runner</title>
    <style>
        body { margin: 0; background: #1a1a1a; color: white; font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; align-items: center; overflow: hidden; }
        #game-info { display: flex; gap: 25px; padding: 15px; font-size: 22px; background: #222; width: 100%; justify-content: center; border-bottom: 3px solid #d35400; }
        
        .game-container { position: relative; width: 800px; height: 350px; background: url('https://i.imgur.com/8D78Z8p.png'); background-size: cover; border-bottom: 5px solid #d35400; overflow: hidden; margin-top: 20px; }
        
        /* –ò–≥—Ä–æ–∫ (–ö–∞—Ä—Ç–∏–Ω–∫–∞) */
        #player { position: absolute; width: 80px; height: 80px; bottom: 5px; left: 60px; z-index: 10; background-size: contain; background-repeat: no-repeat; background-position: bottom; }
        
        /* –°–∫–∏–Ω—ã (—Å—Å—ã–ª–∫–∏ –Ω–∞ GIF) */
        .skin-naruto { background-image: url('https://media.giphy.com/media/tS9P4ZYRAACKA/giphy.gif'); }
        .skin-sakura { background-image: url('https://media.giphy.com/media/11mB6clX6m7fPy/giphy.gif'); }
        .skin-kakashi { background-image: url('https://media.giphy.com/media/U7S86m87A4S76/giphy.gif'); }
        .skin-itachi { background-image: url('https://media.giphy.com/media/7S66f81Beb0t2/giphy.gif'); }

        /* –û–±—ä–µ–∫—Ç—ã */
        .shuriken { position: absolute; width: 40px; height: 40px; background: url('https://i.imgur.com/vHTh7jC.png') no-repeat; background-size: contain; animation: spin 0.4s infinite linear; }
        .gold-shuriken { position: absolute; width: 45px; height: 45px; background: url('https://i.imgur.com/PAnvL2S.png') no-repeat; background-size: contain; filter: drop-shadow(0 0 10px gold); animation: spin 0.2s infinite linear; }
        
        #boss { position: absolute; width: 150px; height: 150px; background: url('https://media.giphy.com/media/o9SgS7UFZLIgE/giphy.gif') no-repeat; background-size: contain; right: 50px; bottom: 5px; display: none; cursor: crosshair; }
        #boss-hp { width: 100px; height: 10px; background: red; position: absolute; top: -20px; left: 25px; border: 2px solid white; }

        .gate { position: absolute; width: 120px; height: 180px; background: url('https://i.imgur.com/Uv7hV7h.png') no-repeat; background-size: contain; bottom: 5px; display: flex; align-items: flex-end; justify-content: center; color: white; font-weight: bold; padding-bottom: 10px; }

        /* –ú–∞–≥–∞–∑–∏–Ω */
        .shop { margin-top: 25px; display: flex; gap: 12px; }
        .shop-item { padding: 12px 18px; background: #333; border: 2px solid #e67e22; cursor: pointer; border-radius: 8px; font-weight: bold; transition: 0.2s; }
        .shop-item:hover { background: #e67e22; }

        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div id="game-info">
    <span>üí∞ –ú–æ–Ω–µ—Ç—ã: <b id="coin-count">0</b></span>
    <span>‚è±Ô∏è –í—Ä–µ–º—è: <b id="timer">30</b>—Å</span>
    <span>‚öîÔ∏è –ò–≥—Ä—ã: <b id="game-count">0</b></span>
</div>

<div class="game-container" id="stage">
    <div id="player" class="skin-naruto"></div>
    <div id="boss" onclick="hitBoss()"><div id="boss-hp"><div id="hp-fill" style="width:100%; height:100%; background: lime;"></div></div></div>
</div>

<div class="shop">
    <div class="shop-item" onclick="buySkin('naruto', 0)">–ù–∞—Ä—É—Ç–æ (0)</div>
    <div class="shop-item" onclick="buySkin('sakura', 15)">–°–∞–∫—É—Ä–∞ (15)</div>
    <div class="shop-item" onclick="buySkin('kakashi', 30)">–ö–∞–∫–∞—à–∏ (30)</div>
    <div class="shop-item" onclick="buySkin('itachi', 50)">–ò—Ç–∞—á–∏ (50)</div>
</div>

<script>
    let coins = parseInt(localStorage.getItem('coins')) || 0;
    let gamesPlayed = parseInt(localStorage.getItem('gamesPlayed')) || 0;
    let timeLeft = 30;
    let isJumping = false;
    let isGameOver = false;
    let bossHP = 100;

    const coinEl = document.getElementById('coin-count');
    const timerEl = document.getElementById('timer');
    const gameEl = document.getElementById('game-count');
    const player = document.getElementById('player');
    const stage = document.getElementById('stage');
    const boss = document.getElementById('boss');

    function updateStats() {
        coinEl.innerText = coins;
        gameEl.innerText = gamesPlayed;
        localStorage.setItem('coins', coins);
        localStorage.setItem('gamesPlayed', gamesPlayed);
    }
    updateStats();

    // –ü—Ä—ã–∂–æ–∫ (–ü—Ä–æ–±–µ–ª –∏–ª–∏ –ö–ª–∏–∫)
    function jump() {
        if (isJumping || isGameOver) return;
        isJumping = true;
        let p = 5;
        let up = setInterval(() => {
            if (p >= 180) {
                clearInterval(up);
                let down = setInterval(() => {
                    if (p <= 5) { clearInterval(down); isJumping = false; }
                    p -= 8; player.style.bottom = p + 'px';
                }, 20);
            }
            p += 10; player.style.bottom = p + 'px';
        }, 20);
    }

    document.addEventListener('keydown', e => { if (e.code === 'Space') jump(); });
    stage.addEventListener('mousedown', jump);

    function spawnEnemy() {
        if (isGameOver) return;
        
        if (gamesPlayed > 0 && gamesPlayed % 5 === 0) {
            boss.style.display = 'block';
            return;
        }

        const isGold = Math.random() < 0.2; // 20% —à–∞–Ω—Å –Ω–∞ –∑–æ–ª–æ—Ç–æ–π —Å—é—Ä–∏–∫–µ–Ω
        const enemy = document.createElement('div');
        enemy.className = isGold ? 'gold-shuriken' : 'shuriken';
        let x = 800;
        enemy.style.left = x + 'px';
        enemy.style.bottom = '20px';
        stage.appendChild(enemy);

        let move = setInterval(() => {
            x -= 10;
            enemy.style.left = x + 'px';
            if (x < -50) { clearInterval(move); enemy.remove(); }
            
            let pr = player.getBoundingClientRect();
            let er = enemy.getBoundingClientRect();

            if (pr.right > er.left && pr.left < er.right && pr.bottom > er.top) {
                if (isGold) {
                    coins += 5; updateStats(); enemy.remove(); clearInterval(move);
                } else {
                    isGameOver = true;
                    alert("–ü—Ä–æ–∏–≥—Ä—ã—à! –ü–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞.");
                    location.reload();
                }
            }
        }, 20);
        setTimeout(spawnEnemy, 1500 + Math.random() * 1000);
    }

    function startTimer() {
        let clock = setInterval(() => {
            if (boss.style.display === 'block' || isGameOver) return;
            timeLeft--;
            timerEl.innerText = timeLeft;
            if (timeLeft <= 0) { clearInterval(clock); spawnFinish(); }
        }, 1000);
    }

    function spawnFinish() {
        const g = document.createElement('div');
        g.className = 'gate';
        g.innerText = "–§–ò–ù–ò–®";
        let x = 800;
        g.style.left = x + 'px';
        stage.appendChild(g);

        let move = setInterval(() => {
            x -= 5;
            g.style.left = x + 'px';
            let pr = player.getBoundingClientRect();
            let gr = g.getBoundingClientRect();
            if (pr.right > gr.left) {
                clearInterval(move);
                coins += 2; gamesPlayed++; updateStats();
                alert("–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω! +2 –º–æ–Ω–µ—Ç—ã");
                location.reload();
            }
        }, 20);
    }

    function hitBoss() {
        bossHP -= 10;
        document.getElementById('hp-fill').style.width = bossHP + '%';
        if (bossHP <= 0) {
            boss.style.display = 'none';
            coins += 10; gamesPlayed++; updateStats();
            alert("–ë–æ—Å—Å –ø–æ–±–µ–∂–¥–µ–Ω! +10 –º–æ–Ω–µ—Ç");
            location.reload();
        }
    }

    function buySkin(name, price) {
        if (coins >= price) {
            if (price > 0) coins -= price;
            player.className = 'skin-' + name;
            updateStats();
            alert("–°–∫–∏–Ω –∫—É–ø–ª–µ–Ω!");
        } else {
            alert("–ú–∞–ª–æ –º–æ–Ω–µ—Ç!");
        }
    }

    startTimer();
    spawnEnemy();
</script>
</body>
</html>
