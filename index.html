<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naruto: Shinobi Legend</title>
    <style>
        :root { --skin-color: #f39c12; --hair-color: #f1c40f; }
        body { margin: 0; background: #1a1a1a; color: white; font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; align-items: center; overflow: hidden; }
        #game-ui { display: flex; gap: 30px; padding: 20px; font-size: 24px; background: #222; width: 100%; justify-content: center; border-bottom: 4px solid #d35400; }
        
        #stage { position: relative; width: 800px; height: 350px; background: #ecf0f1; border-bottom: 6px solid #d35400; overflow: hidden; margin-top: 20px; box-shadow: 0 0 50px rgba(0,0,0,0.5); }

        /* –ü–ï–†–°–û–ù–ê–ñ */
        #player { position: absolute; width: 50px; height: 75px; bottom: 0; left: 60px; z-index: 10; transition: bottom 0.1s; }
        .p-head { width: 30px; height: 30px; background: #ffdbac; border-radius: 50%; position: absolute; top: 0; left: 10px; border: 2px solid #000; z-index: 2; }
        .p-hair { width: 36px; height: 18px; background: var(--hair-color); position: absolute; top: -5px; left: 7px; border-radius: 20px 20px 0 0; border: 1px solid #000; }
        .p-body { width: 40px; height: 45px; background: var(--skin-color); position: absolute; bottom: 0; left: 5px; border-radius: 5px; border: 2px solid #000; }

        /* –°–Æ–†–ò–ö–ï–ù */
        .shuriken { position: absolute; width: 35px; height: 35px; background: #2d3436; clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%); animation: spin 0.3s infinite linear; border: 1px solid #fff; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* –≠–ö–†–ê–ù –°–ú–ï–†–¢–ò */
        #game-over { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 100; }
        #game-over h1 { color: #e74c3c; font-size: 50px; text-shadow: 0 0 10px #ff0000; }
        .restart-btn { padding: 15px 30px; background: #e67e22; border: 2px solid #fff; color: white; cursor: pointer; border-radius: 10px; font-weight: bold; margin-top: 20px; }

        /* –ú–ê–ì–ê–ó–ò–ù */
        .shop { margin-top: 20px; display: flex; gap: 10px; }
        .shop-btn { padding: 10px; background: #333; border: 1px solid #e67e22; color: white; cursor: pointer; border-radius: 5px; }
    </style>
</head>
<body>

<div id="game-ui">
    <span>üí∞ –ú–æ–Ω–µ—Ç—ã: <b id="coins">0</b></span>
    <span>‚è±Ô∏è –í—Ä–µ–º—è: <b id="timer">30</b>—Å</span>
</div>

<div id="stage" onclick="jump()">
    <div id="player">
        <div class="p-hair" id="hair"></div>
        <div class="p-head"></div>
        <div class="p-body" id="body"></div>
    </div>
    
    <div id="game-over">
        <h1>–ü–û–†–ê–ñ–ï–ù–ò–ï</h1>
        <button class="restart-btn" onclick="location.reload()">–í–ï–†–ù–£–¢–¨–°–Ø –í –ë–û–ô</button>
    </div>
</div>

<div class="shop">
    <div class="shop-btn" onclick="buySkin('naruto', 0)">–ù–∞—Ä—É—Ç–æ (0)</div>
    <div class="shop-btn" onclick="buySkin('sakura', 15)">–°–∞–∫—É—Ä–∞ (15)</div>
    <div class="shop-btn" onclick="buySkin('kakashi', 30)">–ö–∞–∫–∞—à–∏ (30)</div>
    <div class="shop-btn" onclick="buySkin('itachi', 50)">–ò—Ç–∞—á–∏ (50)</div>
</div>

<script>
    let coins = parseInt(localStorage.getItem('naruto_coins')) || 0;
    let isJumping = false;
    let isGameOver = false;
    let timeLeft = 30;

    const coinEl = document.getElementById('coins');
    const timerEl = document.getElementById('timer');
    const player = document.getElementById('player');
    const stage = document.getElementById('stage');

    function updateCoins() {
        coinEl.innerText = coins;
        localStorage.setItem('naruto_coins', coins);
    }
    updateCoins();

    // –ü—Ä—ã–∂–æ–∫
    function jump() {
        if (isJumping || isGameOver) return;
        isJumping = true;
        let p = 0;
        let up = setInterval(() => {
            if (p >= 150) {
                clearInterval(up);
                let down = setInterval(() => {
                    if (p <= 0) { clearInterval(down); isJumping = false; }
                    p -= 7; player.style.bottom = p + 'px';
                }, 20);
            }
            p += 9; player.style.bottom = p + 'px';
        }, 20);
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ —Å—é—Ä–∏–∫–µ–Ω–æ–≤
    function spawn() {
        if (isGameOver) return;
        const s = document.createElement('div');
        s.className = 'shuriken';
        let x = 800;
        s.style.left = x + 'px';
        s.style.bottom = (Math.random() > 0.5 ? '10px' : '70px');
        stage.appendChild(s);

        let move = setInterval(() => {
            if (isGameOver) { clearInterval(move); s.remove(); return; }
            x -= 10;
            s.style.left = x + 'px';

            if (x < -40) {
                clearInterval(move);
                s.remove();
                coins++; updateCoins();
            }

            let pr = player.getBoundingClientRect();
            let sr = s.getBoundingClientRect();
            if (pr.right > sr.left + 10 && pr.left < sr.right - 10 && pr.bottom > sr.top + 10 && pr.top < sr.bottom - 10) {
                isGameOver = true;
                document.getElementById('game-over').style.display = 'flex';
            }
        }, 20);
        setTimeout(spawn, Math.random() * 1500 + 1000);
    }

    // –ú–∞–≥–∞–∑–∏–Ω
    const skins = {
        naruto: { body: '#f39c12', hair: '#f1c40f' },
        sakura: { body: '#ff9ff3', hair: '#feca57' },
        kakashi: { body: '#2f3542', hair: '#dcdde1' },
        itachi: { body: '#000000', hair: '#2d3436' }
    };

    function buySkin(name, price) {
        if (coins >= price) {
            if (price > 0 && !confirm("–ö—É–ø–∏—Ç—å —Å–∫–∏–Ω?")) return;
            coins -= price; updateCoins();
            document.getElementById('body').style.backgroundColor = skins[name].body;
            document.getElementById('hair').style.backgroundColor = skins[name].hair;
            alert("–°–∫–∏–Ω —É—Å–ø–µ—à–Ω–æ –≤—ã–±—Ä–∞–Ω!");
        } else {
            alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!");
        }
    }

    // –¢–∞–π–º–µ—Ä
    setInterval(() => {
        if (isGameOver) return;
        timeLeft--;
        timerEl.innerText = timeLeft;
        if (timeLeft <= 0) {
            alert("–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω! –¢—ã ‚Äî –∏—Å—Ç–∏–Ω–Ω—ã–π –•–æ–∫–∞–≥–µ!");
            location.reload();
        }
    }, 1000);

    document.addEventListener('keydown', e => { if(e.code === 'Space') jump(); });
    spawn();
</script>
</body>
</html>
